
---

# SQL Practice Problems

This document contains practice problems to enhance your SQL skills using the `grocery_store.db` database.

---

## **1. Basic SELECT Queries**
1. Retrieve all details of all customers.
   ```sql
   SELECT * FROM Customers;
   ```
2. List all products in the "Dairy" category.
   ```sql
   SELECT * FROM Products WHERE Category = 'Dairy';
   ```
3. Retrieve the names and email addresses of all customers.
   ```sql
   SELECT Name, Email FROM Customers;
   ```

---

## **2. Filtering with WHERE**
1. Find all products with a price greater than $2.00.
   ```sql
   SELECT * FROM Products WHERE Price > 2.00;
   ```
2. List all customers who live on "Elm St".
   ```sql
   SELECT * FROM Customers WHERE Address LIKE '%Elm St%';
   ```
3. Retrieve orders placed after November 18, 2024.
   ```sql
   SELECT * FROM Orders WHERE OrderDate > '2024-11-18';
   ```

---

## **3. Aggregate Functions**
1. Find the total number of products in the database.
   ```sql
   SELECT COUNT(*) AS TotalProducts FROM Products;
   ```
2. Calculate the average price of all products.
   ```sql
   SELECT AVG(Price) AS AveragePrice FROM Products;
   ```
3. Find the total sales amount for all orders.
   ```sql
   SELECT SUM(TotalAmount) AS TotalSales FROM Orders;
   ```

---

## **4. GROUP BY and HAVING**
1. Count the number of products in each category.
   ```sql
   SELECT Category, COUNT(*) AS ProductCount 
   FROM Products 
   GROUP BY Category;
   ```
2. Find the total stock of products in each category.
   ```sql
   SELECT Category, SUM(Stock) AS TotalStock 
   FROM Products 
   GROUP BY Category;
   ```
3. Retrieve the categories with a total stock greater than 100.
   ```sql
   SELECT Category, SUM(Stock) AS TotalStock 
   FROM Products 
   GROUP BY Category 
   HAVING SUM(Stock) > 100;
   ```

---

## **5. JOINs**
1. Retrieve all orders along with the customer's name who placed them.
   ```sql
   SELECT O.OrderID, C.Name AS Customer, O.OrderDate, O.TotalAmount 
   FROM Orders O
   INNER JOIN Customers C ON O.CustomerID = C.CustomerID;
   ```
2. List all order details along with product names and their respective categories.
   ```sql
   SELECT OD.OrderDetailID, OD.OrderID, P.Name AS Product, P.Category, OD.Quantity, OD.Price 
   FROM OrderDetails OD
   INNER JOIN Products P ON OD.ProductID = P.ProductID;
   ```
3. Find all orders where the total amount is greater than $5 and display the customer's name and order date.
   ```sql
   SELECT C.Name AS Customer, O.OrderDate, O.TotalAmount 
   FROM Orders O
   INNER JOIN Customers C ON O.CustomerID = C.CustomerID 
   WHERE O.TotalAmount > 5;
   ```

---

## **6. Subqueries**
1. Find all products that are part of an order with a total amount greater than $10.
   ```sql
   SELECT DISTINCT P.Name 
   FROM Products P
   WHERE P.ProductID IN (
       SELECT OD.ProductID 
       FROM OrderDetails OD
       INNER JOIN Orders O ON OD.OrderID = O.OrderID
       WHERE O.TotalAmount > 10
   );
   ```
2. Retrieve the names of customers who have placed at least one order.
   ```sql
   SELECT Name 
   FROM Customers 
   WHERE CustomerID IN (
       SELECT CustomerID 
       FROM Orders
   );
   ```
3. Find the most expensive product and its category.
   ```sql
   SELECT Name, Category, Price 
   FROM Products 
   WHERE Price = (SELECT MAX(Price) FROM Products);
   ```

---

## **7. Advanced Queries**
1. Retrieve the top 3 most expensive products.
   ```sql
   SELECT * 
   FROM Products 
   ORDER BY Price DESC 
   LIMIT 3;
   ```
2. Find the total revenue generated by each product.
   ```sql
   SELECT P.Name AS Product, SUM(OD.Quantity * OD.Price) AS Revenue 
   FROM OrderDetails OD
   INNER JOIN Products P ON OD.ProductID = P.ProductID
   GROUP BY P.ProductID 
   ORDER BY Revenue DESC;
   ```
3. List all customers and the total amount they've spent, even if they haven't placed an order.
   ```sql
   SELECT C.Name AS Customer, COALESCE(SUM(O.TotalAmount), 0) AS TotalSpent 
   FROM Customers C
   LEFT JOIN Orders O ON C.CustomerID = O.CustomerID
   GROUP BY C.CustomerID;
   ```

---

## **8. Data Manipulation (DML)**
1. Add a new product to the database.
   ```sql
   INSERT INTO Products (Name, Category, Price, Stock) 
   VALUES ('Orange', 'Fruits', 0.75, 200);
   ```
2. Update the stock for the product "Milk" to 60.
   ```sql
   UPDATE Products 
   SET Stock = 60 
   WHERE Name = 'Milk';
   ```
3. Delete all orders with a total amount less than $3.
   ```sql
   DELETE FROM Orders 
   WHERE TotalAmount < 3;
   ```

---

## **9. Data Definition (DDL)**
1. Add a new column `Discount` to the `Products` table.
   ```sql
   ALTER TABLE Products ADD Discount REAL;
   ```
2. Rename the column `Name` in the `Customers` table to `FullName`.
   ```sql
   ALTER TABLE Customers RENAME COLUMN Name TO FullName;
   ```
3. Drop the `Discount` column from the `Products` table.
   ```sql
   ALTER TABLE Products DROP COLUMN Discount;
   ```

---

## **10. Challenge Problems**
1. Find the customer who has spent the most money.
   ```sql
   SELECT C.Name, SUM(O.TotalAmount) AS TotalSpent 
   FROM Customers C
   INNER JOIN Orders O ON C.CustomerID = O.CustomerID
   GROUP BY C.CustomerID 
   ORDER BY TotalSpent DESC 
   LIMIT 1;
   ```
2. Find the product that has been sold the most (by quantity).
   ```sql
   SELECT P.Name AS Product, SUM(OD.Quantity) AS TotalSold 
   FROM Products P
   INNER JOIN OrderDetails OD ON P.ProductID = OD.ProductID
   GROUP BY P.ProductID 
   ORDER BY TotalSold DESC 
   LIMIT 1;
   ```
3. List all customers who haven't placed any orders.
   ```sql
   SELECT Name 
   FROM Customers 
   WHERE CustomerID NOT IN (
       SELECT CustomerID 
       FROM Orders
   );
   ```

---

## **How to Use These Problems**
1. Save this file as `problems.md` in your project directory.
2. Solve problems directly in the SQLite terminal or write Python scripts to execute queries.
3. Challenge yourself by modifying these queries or creating new ones.

Happy learning! ðŸš€